# Detecting Concurrency Vulnerabilities Based on Partial Orders of Memory and Thread Events FSE 2021

* æœ¬æ–‡å®é™…ä¸Šæ˜¯ <a href="https://github.com/Anderson-Xia/Note/blob/main/2021_10_16.md" >2021_10_16</a> ä¸­è®ºæ–‡çš„ä¸€ä¸ªæ‰©å……

* æœ¬æ–‡åŠå…¶å‰ä½œéƒ½ä½¿ç”¨intel PINè¿›è¡ŒåŠ¨æ€æ’æ¡©
## Insight:

 æœ¬æ–‡æå‡ºäº†Partial Orderï¼Œå³ä¸€ç³»åˆ—äº‹ä»¶çš„æ‰§è¡Œé¡ºåºã€‚ä¸å…¶å‰ä½œçš„ä¸»è¦å…³è”ä¸º **åœ¨å‰ä½œçš„åŸºç¡€ä¸Šè®¾è®¡äº†ä¸€ç§åœ¨å·²çŸ¥ trace ä¸Š reorder äº‹ä»¶æ‰§è¡Œé¡ºåºï¼ˆPartial Orderï¼‰çš„ç®—æ³•**ï¼Œç”¨äºæ›´å¥½çš„æš´éœ²æ¼æ´

## A Motivating Example

![limits](https://raw.githubusercontent.com/Anderson-Xia/Note/main/img/20211018/2021101801@2x.png)

å¦‚ä¸Šå›¾ï¼Œä½œè€…æå‡ºï¼Œå¯ä»¥é€šè¿‡é‡æ„ (a) ä¸­trace çš„ Partial Order,å¾—åˆ°ä¸€ä¸ªæ–°çš„trace,ä»è€Œä½¿e14(null->y)åœ¨e11(deref(y))ä¹‹å‰æ‰§è¡Œï¼Œå¼•å‘NPD

å…·ä½“æ­¥éª¤ä¸º æå–æ‰€éœ€çš„eventsï¼Œä½œè€…è®¤ä¸º, t2ä¸­ä¸å«å†™æ“ä½œï¼Œä¸”ä¸å½±å“å…¶ä»–çº¿ç¨‹ï¼Œæ‰€ä»¥å±äºæ— éœ€æå–çš„éƒ¨åˆ†ï¼Œæœ€åæå–å¾—åˆ° partial order graph (b)ï¼Œéšåä½¿ç”¨ additional edge è¿æ¥è·¨çº¿ç¨‹çš„event,é‡æ„æ‰§è¡Œé¡ºåº

ä»¥(b)ä¸ºä¾‹ï¼Œé‡æ„åçš„é¡ºåºä¸º `ğ‘’1, ğ‘’9, ğ‘’2, ğ‘’3, ğ‘’4, ğ‘’5, ğ‘’13, ğ‘’14, ğ‘’15, ğ‘’10, ğ‘’11`

---

## Feasible Event Sets

åœ¨æœ¬èŠ‚ä¸­ï¼Œä½œè€…ç»™å‡ºå®šä¹‰ï¼Œä»ä¸€ä¸ªå·²æœ‰çš„traceä¸­æå–å¯è¡Œçš„äº‹ä»¶é›†åˆï¼ˆFeasible Events Setï¼‰éœ€è¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶

* å‰åºé—­åŒ… â€”â€” å¯¹äº ğ‘’2 âˆˆ Eğœâ€²ä¸” ğ‘’1 <ğœâ†¾ ğ‘’2ï¼Œæœ‰ ğ‘’1 âˆˆ Eğœâ€²

* å¯è¡Œé” â€”â€” å¯¹äºæ¯ä¸ªrelï¼Œå…¶å¯¹åº”çš„acqåº”å±äºEğœâ€²ï¼Œå¯¹äºæ¯ä¸ªé”ï¼Œæœ€å¤šæœ‰ä¸€ä¸ªOpenacqï¼ˆå³åœ¨Eğœâ€²æ²¡æœ‰å¯¹åº”çš„acqï¼‰

* å¯è§‚å¯Ÿ â€”â€” ifâˆ€ğ‘Ÿ âˆˆ R(Eğœâ€²),ğ‘œğ‘ğ‘ ğœ (ğ‘Ÿ) âˆˆ Eğœâ€²ï¼Œå³å¯¹äºæ¯ä¸ªè¯»æ“ä½œï¼Œå…¶æœ€è¿‘çš„å†™æ“ä½œä¹ŸåŒ…å«åœ¨Eğœâ€²ä¸­

## Trace-Closed Partial Orders

å°†ä¸Šè¿°ä¸‰ä¸ªæ¡ä»¶ç±»æ¯”åˆ°Partial Orderä¸­ï¼Œä½œè€…å®šä¹‰äº† `Trace-Closed Partial Orders`ï¼Œå‚è§åŸæ–‡

## Prototype

![limits](https://raw.githubusercontent.com/Anderson-Xia/Note/main/img/20211018/2021101802.png)

ConVulPOEå®Œæ•´æµç¨‹å¦‚ä¸Šå›¾

æ’æ¡©å¾…æµ‹ç¨‹åºï¼Œè¿è¡Œå¹¶è®°å½•traceï¼Œä½¿ç”¨é’ˆå¯¹ä¸‰ç§å¯èƒ½å¯¼è‡´æ¼æ´çš„pairsï¼Œè®¡ç®—å…¶Feasible Event Sets,éšåæ„å»ºé‡æ’åºçš„traceå¹¶éªŒè¯

## ä¸å‰ä½œçš„åŒºåˆ«

æœ¬æ–‡ä¸å…¶å‰ä½œConVulæœ€å¤§çš„åŒºåˆ«æ˜¯ï¼Œå‰ä½œçš„æœç´¢ç®—æ³•åŸºäºåœ¨runtimeä¸­è®°å½•çš„å¯äº¤æ¢äº‹ä»¶ï¼Œè€Œæœ¬æ–‡åˆ™è®¾å®šäº†æ›´å¤æ‚çš„çº¦æŸä»¥å¯»æ‰¾potential pairsï¼Œä¸å†æ‹˜æ³¥äºå‰ä½œå®šä¹‰çš„äº¤æ¢è·ç¦»åŠHBR

å…¶æ¬¡ï¼Œæœ¬æ–‡åœ¨é‡æ’åºéªŒè¯è¿‡ç¨‹ä¸­è®¾è®¡äº†æ›´ç²¾ç»†çš„Partial Order,è€Œä¸æ˜¯ç®€å•çš„åªå¯¹å¯äº¤æ¢äº‹ä»¶é‡æ’åºï¼Œæ¶ˆé™¤äº†False Positive